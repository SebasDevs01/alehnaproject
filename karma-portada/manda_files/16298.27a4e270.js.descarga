"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["16298"],{87383:function(e,r,n){n.d(r,{E:function(){return d}});var t=n(5377),o=n(2787),i=n(85400),u=n(17505),a=n(84287),s=n(97726),c=n(61724),l=n(82258),d=function(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.s.BrowserMode;return function(a){var d,f=(0,i.u)(e,r,n)(a),m=(0,l.A)(e,r,n)(a),v=(0,s.N)({itemListKey:e})(a),h=function(e){var r=(0,c.uA)().enableImmersivePlayer,n=(0,u.vkb)().isRefactorGroup,i=(0,u.Vv$)().isInProductHoldout;return r?(0,o.Y)(v,(0,t._)({},e)):(0,o.Y)(n&&!i?m:f,(0,t._)({},e))};return h.displayName="WithOverlayPlayer(".concat(null!=(d=a.displayName)?d:a.name,")"),h}}},99784:function(e,r,n){n.d(r,{Em:function(){return s},WA:function(){return a},f8:function(){return i},mo:function(){return u}});var t=n(17407),o=n(11854),i=function(){return(0,t.o$)(function(e){return e.needClearInput})},u=function(){return(0,t.o$)(function(e){return e.replyCid})},a=function(){return(0,t.o$)(function(e){return e.isInputFocus})},s=function(e){var r=(0,t.o$)(function(e){return{isCommentInputEmpty:e.isInputEmpty,isReplyInputEmpty:e.isReplyInputEmpty}},o.bN),n=r.isCommentInputEmpty,i=r.isReplyInputEmpty;return e?i:n&&i}},39845:function(e,r,n){n.d(r,{dY:function(){return g},gs:function(){return y},mL:function(){return b}});var t=n(41386),o=n(5377),i=n(45996),u=n(16327),a=n(6586),s=n(69513),c=n(40099),l=n(11854),d=n(82761),f=n(62650),m=n(48859),v=n(72961),h=n(43264),w=n(59384),p=n(44117),_=n(50720),y=(0,d.$)("BrowserContext@tiktok/fe-shared")({isBrowserModeShowing:!1,showBrowserMode:s.A,closeBrowserMode:s.A}),g=(0,d.$)("BrowserViewContext@tiktok/fe-shared")({currentIndex:-1,itemListKey:null,enterFrom:void 0,teaParams:{}});function b(){var e=(0,a._)((0,c.useState)(!1),2),r=e[0],n=e[1],s=(0,a._)((0,c.useState)({}),2),d=s[0],y=s[1],g=(0,a._)((0,c.useState)(),2),b=g[0],L=g[1],C=(0,a._)((0,w.BI)(function(e){return{showingBrowserMode:e.showingBrowserMode,itemListKey:e.itemListKey,currentIndex:e.currentIndex,enterWindowTimeSec:e.enterWindowTimeSec}},l.bN),2),P=C[0],M=P.showingBrowserMode,k=P.itemListKey,S=P.currentIndex,B=P.enterWindowTimeSec,R=C[1],I=(0,c.useRef)(0),E=(0,c.useRef)(0),T=(0,c.useRef)(0),x=(0,c.useRef)(0),N=(0,c.useRef)(0),D=(0,c.useRef)(null),V=(0,c.useRef)(null),K=(0,_.hL)({currentIndex:S}),A=K.authorId,Y=K.groupId,F=(0,v.L$)((0,h.W)(function(){return["user"]},[])).user,U=(0,c.useMemo)(function(){return{author_id:A,group_id:Y}},[A,Y]),O=(0,c.useCallback)(function(){var e=Math.floor((Number(new Date)-E.current)/1e3),r=(0,i._)((0,o._)((0,i._)((0,o._)({},f.L.getScreenRatio()),{duration:e}),U),{play_mode:m.Tk.BrowserMode});f.L.handleExitBrowser(r)},[U]),q=function(){null!==V.current&&window.removeEventListener("resize",V.current)};(0,c.useEffect)(function(){var e,n=function(){if(r){var e=f.L.getScreenRatio(),n=e.height_max,t=e.width_max,i=e.width,u=e.height,a=e.height_ratio,s=e.width_ratio,c=Number(new Date),l=(0,o._)({height_ratio_after:a,width_ratio_after:s,height_ratio:x.current/n,width_ratio:N.current/t,height_after:u,width_after:i,height:x.current,width:N.current,height_max:n,width_max:t,duration:(c-T.current)/1e3},U);T.current=c,x.current=u,N.current=i,f.L.handleAdjustBrowserSize(l)}};if(q(),r){var t=function(){clearTimeout(e),e=setTimeout(n,500)};window.addEventListener("resize",t),V.current=t}if(0===I.current){var i=Number(new Date);I.current=i,E.current=i,T.current=i}return function(){q()}},[r,U]);var W=(0,c.useMemo)(function(){return{capture:!0}},[]),$=(0,c.useCallback)(function(){null!==D.current&&window.removeEventListener("beforeunload",D.current,W)},[W]);(0,c.useEffect)(function(){var e=function(){var e=Math.floor((Number(new Date)-B)/1e3),n=(0,o._)((0,i._)((0,o._)({},f.L.getScreenRatio()),{duration:e}),r?U:{});f.L.handleCloseWindow(n),r&&O()};return $(),D.current=e,window.addEventListener("beforeunload",e,W),function(){$()}},[$,B,r,W,O,U]);var z=(0,p.J)();return{itemListKey:k,currentIndex:S,showBrowserMode:(0,c.useCallback)(function(e){if(!z()){var r=e.teaParams,a=e.reportTeaParams,s=e.enterFrom,c=(0,u._)(e,["teaParams","reportTeaParams","enterFrom"]);(0,t._)(document.activeElement,HTMLElement)&&document.activeElement.blur(),R.showBrowserMode(c),n(!0),y(null!=r?r:{}),L(s);var l=(null==r?void 0:r.author_id)&&(null==F?void 0:F.uid)===r.author_id,d=f.L.getScreenRatio(),v=(0,i._)((0,o._)({},null!=a?a:r,d),{play_mode:m.Tk.BrowserMode,is_self_content:l}),h=d.width;x.current=d.height,N.current=h;var w=Number(new Date);E.current=w,T.current=w,f.L.handleEnterBrowserOpt(v)}},[R,z]),closeBrowserMode:(0,c.useCallback)(function(e){n(!1),R.closeBrowserMode(e),O()},[R,O]),isBrowserModeShowing:M,disableUpdate:!r,teaParams:d,enterFrom:b}}},82258:function(e,r,n){n.d(r,{A:function(){return p}});var t=n(5377),o=n(2787),i=n(40099),u=n(41150),a=n(59384),s=n(82232),c=n(43599),l=n(84287),d=n(15764),f=n(6232),m=n(15305),v=n(55169),h=n(39845),w=(0,v.Rq)({resolved:{},chunkName:function(){return"instance"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("96821"),n.e("49871"),n.e("41685"),n.e("84673"),n.e("44810"),n.e("19517"),n.e("79447"),n.e("18008"),n.e("2536"),n.e("18684"),n.e("50613"),n.e("17214"),n.e("34807"),n.e("69435"),n.e("17866"),n.e("584"),n.e("71522"),n.e("49750"),n.e("85439"),n.e("50210"),n.e("52861"),n.e("8324"),n.e("4722"),n.e("89828"),n.e("32132"),n.e("74929"),n.e("88447"),n.e("96308"),n.e("99698"),n.e("5244"),n.e("56448"),n.e("12707"),n.e("84363"),n.e("96439"),n.e("96755"),n.e("37718"),n.e("14725"),n.e("55759"),n.e("96261"),n.e("79874"),n.e("74898"),n.e("23382"),n.e("85178"),n.e("28939")]).then(n.bind(n,73643))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 73643}},(0,t._)({},u.KE));function p(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.s.BrowserMode;return function(u){var l=function(l){var m=(0,h.mL)(),v=m.closeBrowserMode,p=m.isBrowserModeShowing,_=m.disableUpdate,y=m.showBrowserMode,g=m.currentIndex,b=m.enterFrom,L=m.teaParams,C=(0,a.YZ)(),P=(0,i.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.playProgress,t=e.fromPopState;v({playProgress:n,shouldPause:e.shouldPause}),!t&&r&&window.history.back()},[v]),M=(0,i.useCallback)(function(){C.setClickSamePage()},[C]);(0,s.N)(function(){p&&v(void 0)}),(0,i.useEffect)(function(){C.setItemListKey(e)},[C]),(0,i.useEffect)(function(){(0,d.uQ)(f.Y.BrowseModeRerender)});var k=(0,i.useMemo)(function(){return{closeBrowserMode:v,showBrowserMode:y,isBrowserModeShowing:p}},[v,y,p]),S=(0,i.useMemo)(function(){return{currentIndex:g,itemListKey:e,enterFrom:b,teaParams:L}},[g,b,L]);return(0,c.w)(),(0,o.Y)(h.gs.Provider,{value:k,children:(0,o.FD)(h.dY.Provider,{value:S,children:[(0,o.Y)(u,(0,t._)({},l)),p&&(0,o.Y)(w,{disableUpdate:_,needUrlDelegate:r,zIndex:n,onCloseBrowserMode:P,onJumpSamePage:M})]})})};return l.displayName="WithBrowserMode(".concat((0,m.x)(u),")"),l}}},50720:function(e,r,n){n.d(r,{Bc:function(){return ed},DA:function(){return en},DX:function(){return ec},HK:function(){return el},Il:function(){return j},JE:function(){return X},RH:function(){return et},V0:function(){return ee},dD:function(){return Q},hL:function(){return eu},ih:function(){return es},pk:function(){return eo},rw:function(){return ea},wP:function(){return ei}});var t=n(5377),o=n(6586),i=n(53036),u=n(26869),a=n(40099),s=n(11854),c=n(10874),l=n(85223),d=n(21931),f=n(90314),m=n(89786),v=n(77443),h=n(23680),w=n(48859),p=n(47149),_=n(43691),y=n(37786),g=n(62650),b=n(80281),L=n(39950),C=n(59952),P=n(17407),M=n(62085),k=n(31847),S=n(32536),B=n(38306),R=n(72961),I=n(93844),E=n(23636),T=n(45615),x=n(80863),N=n(84501),D=n(30234),V=n(32878),K=n(19298),A=n(59384),Y=n(83168),F=n(80599),U=n(78790),O=n(89130),q=n(11196),W=n(19660),$=n(35521),z=n(31926),H=n(17505),J=n(32906),Z=n(99784);function Q(e){var r=e.itemListKey,n=e.item,t=e.author,o=e.needUrlDelegate,s=e.disableUpdate,l=void 0!==s&&s,d=(0,c.useLocation)(),m=d.pathname,v=d.search,h=(0,c.useHistory)(),w=(0,T._u)(),p=(0,a.useRef)(!1);(0,a.useEffect)(function(){if(n&&r&&o&&!l){(0,c.matchPath)(location.pathname,{path:f.vI.liveRoom})&&(p.current=!0);var e=n.scheduleTime,a=n.author,s=(0,i.A)((0,u.parse)(v),"sender_device","sender_web_id","item_id"),d=e?(0,x.fJ)({uniqueId:void 0===a?"":a,secUid:null==t?void 0:t.secUid}):(0,u.stringifyUrl)({url:w(n),query:s},{skipNull:!0});if(p.current&&null!==window.history.state&&/^(?!.*@.*\/video).*$/.test(location.pathname)&&/^(?!.*@.*\/photo).*$/.test(location.pathname))return void window.history.replaceState(null,"",location.pathname);p.current?window.history.replaceState(window.history.state,"video-detail",d):(window.history.pushState(window.history.state,"video-detail",d),p.current=!0)}},[null==t?void 0:t.secUid,h,n,m,r,o,v,l])}function j(e){var r=e.onCloseBrowserMode,n=(0,o._)((0,v.S)(N.C,{dependencies:[],selector:function(e){return{searchValue:e.searchValue,previousSearchValue:e.previousSearchValue}}}),2),t=n[0],i=t.searchValue,u=t.previousSearchValue,s=n[1],c=s.setPreviousSearchValue,l=s.setSearchValue,d=s.setInputFocus;(0,a.useEffect)(function(){c(i),l("");var e=function(){l(u),d(!1),r({fromPopState:!0})};return window.addEventListener("popstate",e),function(){window.removeEventListener("popstate",e)}},[])}var G=function(e){null==e||e.preventDefault(),null==e||e.stopPropagation()};function X(e){var r=e.onCloseBrowserMode,n=e.onNextVideo,i=e.onPrevVideo,u=e.pause,s=e.setPause,d=e.embedVisibleRef,f=e.group_id,C=e.handleLikeClick,k=e.author_id,S=e.itemListKey,B=e.onJumpSamePage,R=e.shouldPause,I=e.photoVideoRef,E=e.isPhotoMode,T=e.photoTeaParams,x=e.setIsShowPhoto,W=e.itemMute,$=e.playerRef,z=(0,D.m)().isRTL,H=(0,o._)((0,a.useState)(!1),2),J=H[0],Q=H[1],j=(0,o._)((0,a.useState)(0),2),X=j[0],ee=j[1],er=(0,Z.Em)(),en=(0,P.$4)().setNeedClearInput,et=(0,v.w)(V.aL),eo=(0,o._)((0,v.S)(N.C,{dependencies:[],selector:function(e){return{previousSearchValue:e.previousSearchValue,searchValue:e.searchValue}}}),2),ei=eo[0],eu=ei.previousSearchValue,ea=ei.searchValue,es=eo[1].setSearchValue,ec=(0,K.ah)({playMode:w.ey.BrowserMode,itemMute:void 0!==W&&W}),el=ec.mute,ed=ec.setMute,ef=(0,o._)((0,A.BI)(function(e){return e.isCreatorBrowserMode}),2),em=ef[0],ev=ef[1],eh=(0,a.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),ed(!el,p.c.Keydown,T)},[ed,el,T,f,k]),ew=(0,h.P)(Y.hf,{selector:function(e){return e.showing},dependencies:[]}),ep=(0,h.P)(F.y7,{selector:function(e){return e.showing},dependencies:[]}),e_=(0,M.mZ)(function(e){return e.isOpen}),ey=(0,a.useCallback)(function(e){var r,n,t,o,i,a,c,l,d,f,m,v,h,w,p,_;E?u?(null==(t=I.current)||null==(n=t.swiper)||null==(r=n.play)||r.call(n),null==(a=I.current)||null==(i=a.audio)||null==(o=i.play)||o.call(i)):(null==(d=I.current)||null==(l=d.swiper)||null==(c=l.pause)||c.call(l,e),null==(v=I.current)||null==(m=v.audio)||null==(f=m.pause)||f.call(m)):u?null==(w=$.current)||null==(h=w.play)||h.call(w,!0):null==(_=$.current)||null==(p=_.pause)||p.call(_),s(!u)},[E,s,u,I,f,k,$]),eg=(0,c.useLocation)().pathname,eb=(0,c.useHistory)(),eL=(0,a.useCallback)(function(e,n){if(G(e),es(eu),er){var t;r({fromPopState:n,playProgress:null==(t=$.current)?void 0:t.currentTime,shouldPause:R})}else ee(1),Q(!0)},[er,R,r,eu,es,$]),eC=(0,a.useCallback)(function(e){G(e),ev.handleExitCreatorMode()},[ev]),eP=(0,a.useRef)(-1),eM=(0,a.useCallback)(function(e){var r,n,t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.c.Click,i=e>0?V.RW.Forward:V.RW.BackWard;window.clearTimeout(eP.current),et.setSeekType(i),eP.current=window.setTimeout(function(){et.setSeekType(V.RW.None)},2e3),null==(t=$.current)||null==(n=t.seekTime)||n.call(t,(null==(r=$.current)?void 0:r.currentTime)+e),_.V.handleVideoControlChange({play_mode:w.Tk.BrowserMode,author_id:null!=k?k:"",group_id:f,enter_method:o,click_section:o===p.c.Click?"pc_web_keyboard_btn":void 0,change_params:e>0?"video_forward":"video_backward"})},[k,f]),ek=(0,a.useRef)(""),eS=(0,a.useCallback)(function(e,r,n){if(r.includes(eg)&&eg!==m.OZ.home){eL(e),B();return}er||(G(e),ee(4),Q(!0),ek.current=r),n&&y.O.handleGeneralClick(n,{scene:"video_feed"})},[eL,er,eg,B]),eB=(0,a.useCallback)(function(){E&&(x(!1),setTimeout(function(){x(!0)},0))},[E,x]),eR=(0,l.Rx)(),eI=(0,a.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.c.Click;if(e&&G(e),eR(r),ea&&es(""),er){n(),s(!1);var o=(0,t._)({enter_method:r,play_mode:w.Tk.BrowserMode,group_id:f,author_id:null!=k?k:"",skipped_group_num:0,skipped_group_ids:""},T);g.L.handleVideoChange(o,"next"),eB()}else ee(3),Q(!0)},[eR,ea,es,er,n,s,f,k,T,eB]),eE=(0,a.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.c.Click;if(e&&G(e),eR(r),ea&&es(""),er){i(),s(!1);var n=(0,t._)({enter_method:r,play_mode:w.Tk.BrowserMode,group_id:f,author_id:null!=k?k:"",skipped_group_num:0,skipped_group_ids:""},T);g.L.handleVideoChange(n,"prev"),eB()}else ee(2),Q(!0)},[er,i,s,f,k,T,S,eB,ea,es]),eT=(0,a.useCallback)(function(e){e&&G(e),ea&&es(""),er?(s(!1),eB()):(ee(3),Q(!0))},[er,s,eB,ea,es]),ex=(0,U.mE)(function(e){return{isMiniPlayerShowing:e.isMiniPlayerShowing}}).isMiniPlayerShowing,eN=(0,a.useCallback)(function(e){if(!(e.keyCode!==O.D.Esc&&["input","textarea"].includes(e.target.tagName.toLocaleLowerCase()))&&"true"!==e.target.getAttribute("contenteditable")&&!e_){var r=new Map([[O.D.Esc,function(){!ex&&(em?(eC(e),s(!1)):ew||ep||d.current||eL(e))}],[O.D.Down,function(){eI(e,p.c.Keydown)}],[O.D.Space,function(){ey(b.kC.Keyboard)}],[O.D.Right,function(){eM(z?q.a:q.S,p.c.Keydown)}],[O.D.Left,function(){eM(z?q.S:q.a,p.c.Keydown)}],[O.D.Up,function(){eE(e,p.c.Keydown)}],[O.D.L,function(){C(p.c.Keydown)}],[O.D.M,function(){eh(e)}]]),n=e.keyCode;r.has(n)&&(e.preventDefault(),r.get(n)())}},[d,eL,C,eI,eE,eh,e_,ew,ep,ey,eC,em,eM,z,s,ex]),eD=(0,a.useCallback)(function(){switch(X){case 1:var e;r({playProgress:null==(e=$.current)?void 0:e.currentTime,shouldPause:R});break;case 2:i(),s(!1);break;case 3:n(),s(!1);break;case 4:ek.current&&eb.push(ek.current)}Q(!1),en(!0),L.ao.handleLeaveComment({group_id:f})},[X,f,eb,R,r,n,i,en,s]),eV=(0,a.useCallback)(function(){ee(0),Q(!1),L.ao.handleKeepComment({group_id:f})},[f]);return(0,a.useEffect)(function(){return document.addEventListener("keydown",eN),function(){document.removeEventListener("keydown",eN)}},[eN]),{handleLinkClick:eS,handleClose:eL,handleCloseCreatorMode:eC,handleNext:eI,handlePrev:eE,preventDefault:G,togglePlay:ey,showLeaveModal:J,noEditingContent:er,handleConfirmLeave:eD,handleCancelLeave:eV,handleSeek:eM,handleClickCreatorVid:eT}}function ee(e){var r=e.id,n=e.authorId,t=e.playMode,o=e.needDispose,i=void 0===o||o,u=e.handleCommentScrollDown,s=e.handleCommentHitTop,c=(0,k.BY)(),l=(0,a.useRef)(null),d=(0,a.useCallback)(function(){L.ao.handleCommentLoadMore({play_mode:t,group_id:r,author_id:n}),c.fetchComment({aweme_id:r})},[c,r]);return(0,a.useEffect)(function(){return function(){i&&c.setCommentItem({itemId:r,item:k.lN})}},[c,r,i]),(0,W.O9)({elemRef:l,onHitBottom:d,bottomThreshold:200,throttle:200}),(0,W.yE)({elemRef:l,onHitTop:s,onScrollDown:u}),l}function er(e,r){L.ao.handleClose({group_id:e,is_comments_loaded:r?L.uO.Loading:L.uO.Loaded})}function en(e){var r=e.group_id,n=(0,k._B)(function(e){var n;return null!=(n=e[r])?n:{loading:!1}},s.bN).loading;(0,a.useEffect)(function(){return function(){er(r,n)}},[r])}function et(e){var r=e.group_id,n=(0,k._B)(function(e){var n;return null!=(n=e[r])?n:{loading:!1}},s.bN).loading;(0,a.useEffect)(function(){er(r,n)},[])}var eo=function(e){var r=e.currentIndex,n=(0,A.JD)(function(e){return e.isCreatorBrowserMode});return(0,$.d8)(function(e){return(null==e?void 0:e.browserList)?{currentId:(n?e.creatorBrowserList:e.browserList)[r]}:null},s.bN)},ei=function(){var e=(0,A.JD)(function(e){return e.isCreatorBrowserMode});return(0,$.d8)(function(r){return(null==r?void 0:r.browserList)?{listLength:(e?r.creatorBrowserList:r.browserList).length}:null},s.bN)},eu=function(e){var r,n=e.currentIndex,t=(0,R.L$)(eo({currentIndex:n})).currentId,o=(0,R.L$)((0,z.k)(void 0===t?"":t)),i=null!=(r=null==o?void 0:o.id)?r:"";return{authorId:null==o?void 0:o.authorId,groupId:i}};function ea(e,r,n){var t=(0,o._)((0,S.sK)(function(e){var r,n,t;return{loading:null!=(r=e.loading)&&r,hasMoreLatest:null!=(n=e.hasMoreLatest)&&n,hasMorePrevious:null!=(t=e.hasMorePrevious)&&t}},s.bN),2),i=t[0],u=i.loading,c=i.hasMoreLatest,l=i.hasMorePrevious,f=t[1];return(0,a.useCallback)(function(){(!n||!u&&c)&&(n||!u&&l)&&f.getCreatorTabList({key:B.Lz.CreatorTab,secUid:e,createTime:r,fetchType:n?d.N.LoadLatest:d.N.LoadPrevious})},[u,l,c,n,e,r,f])}var es=function(){var e=(0,I.s)(),r=e("pc_web_login"),n=e("pc_web_login_to_comment"),t=n.indexOf("%s");return{prefixText:n.slice(0,t),loginText:r,endText:n.slice(t).replace("%s","")}},ec=function(e){return e?new Map([[B.Lz.ForYou,"one-column-item"],[B.Lz.Following,"one-column-item"]]).get(e):e},el=function(e,r,n){var t=(0,H.reW)().withMultiInstance,o=(0,C.RT)(),i=o===r,u=o===w.ey.BrowserMode,a=(0,C.w)(e,r,n),s=(0,C.R3)(e,r),c=E.b.DEFAULT;return i&&u?c=a?E.b.ACTIVE:s&&t?E.b.BACKUP:E.b.DEFAULT:i&&(c=E.b.ACTIVE),c};function ed(e){var r=e.handleNext,n=e.handlePrev,t=e.currentId,o=(0,H.TFl)(),i=o.fixLastRef,u=o.scrollOPT,s=(0,a.useRef)(""),c=(0,a.useRef)(0),l=(0,a.useRef)(0),d=(0,a.useRef)(null),f=(0,a.useRef)(!0),m=(0,a.useRef)(""),v=(0,a.useRef)(null),h=(0,a.useRef)(0),w=(0,J._g)(function(e){if(s.current!==t||i){e.stopPropagation(),d.current&&clearTimeout(d.current),d.current=window.setTimeout(function(){l.current=0},100);var o=new Date().getTime(),u=Math.max(-1,Math.min(1,e.wheelDelta||-e.deltaY||-e.detail)),a=o-c.current;l.current=l.current+1,c.current=o,a>100&&1===l.current&&(u<0?r(e,p.c.Scroll):n(e,p.c.Scroll),i||(s.current=t))}},[t,r,n],20),_=(0,a.useCallback)(function(e){var t,o=e.deltaY,i=null!=(t=e.timeStamp)?t:performance.now(),u=i-(h.current||i);h.current=i;var a=o<0?"prev":o>0?"next":"";if(a&&!(10>Math.abs(o))){a!==m.current&&(v.current&&clearTimeout(v.current),f.current=!0);var s=0!==e.deltaMode||Math.abs(o)>=30&&u>35;f.current&&("next"===a?r(e,p.c.Scroll):n(e,p.c.Scroll),f.current=!1,m.current=a),v.current&&clearTimeout(v.current),v.current=window.setTimeout(function(){f.current=!0},s?160:300)}},[r,n]),y=(0,a.useCallback)(function(e){u?_(e):w(e)},[u,w,_]);return(0,a.useEffect)(function(){return function(){d.current&&clearTimeout(d.current),v.current&&clearTimeout(v.current)}},[]),y}},97726:function(e,r,n){n.d(r,{N:function(){return S}});var t=n(5377),o=n(45996),i=n(6586),u=n(2787),a=n(40099),s=n(43264),c=n(59384),l=n(44117),d=n(18117),f=n(90542),m=n(62650),v=n(48859),h=n(45755),w=n(38306),p=n(20386),_=n(72961),y=n(55169),g=n(11854),b=n(47),L=n(61724),C=n(38424),P=n(96375),M=n(24874),k=(0,y.Ay)({resolved:{},chunkName:function(){return"immersive-player"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("96821"),n.e("41685"),n.e("84673"),n.e("44810"),n.e("19517"),n.e("79447"),n.e("18008"),n.e("50613"),n.e("17214"),n.e("69435"),n.e("17866"),n.e("47002"),n.e("71522"),n.e("49750"),n.e("50210"),n.e("52861"),n.e("8324"),n.e("89828"),n.e("74929"),n.e("88447"),n.e("99698"),n.e("42271"),n.e("32974"),n.e("56448"),n.e("12707"),n.e("33842"),n.e("96261"),n.e("92524"),n.e("72335")]).then(n.bind(n,57800))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 57800}}),S=function(e){var r=e.itemListKey;return function(e){var n,y=function(n){var y=(0,L.uA)().isCommentsDefaultOpen,S=(0,_.L$)((0,s.W)(function(){return["user"]},[])).user,B=(0,i._)((0,c.BI)(function(e){return e.showingBrowserMode},g.bN),2),R=B[0],I=B[1],E=(0,i._)((0,h.vZ)(function(e){return{isImmersivePlayerOpen:e.isOpen}},g.bN),2),T=E[0].isImmersivePlayerOpen,x=E[1],N=(0,C.R0)(function(e){return{selectedTab:e.selectedTab}},g.bN).selectedTab,D=(0,M.w)(r).list,V=(0,P.Cd)(),K=V.enterTimeRef,A=V.closeImmersivePlayer,Y=(0,l.J)(),F=(0,b.eK)().isUserPage,U=(0,a.useMemo)(function(){return r===w.Lz.ForYou||r===w.Lz.Friends||r===w.Lz.Following},[]);(0,a.useEffect)(function(){T!==R&&I.setShowingBrowserMode(T)},[I,T,R]);var O=(0,a.useCallback)(function(e,n,t,o){var i=null!=n?n:F?N:r,u={index:e,itemListSourceConfig:t?{mode:"id",source:"user-playlist",id:t}:{mode:"single",itemListKey:i},isCommentsOpen:U||y,teaParams:o};return(0,p.D)(r)||(u.id=D[e]),u},[x,y,U,F,N,D]),q=(0,a.useCallback)(function(e){var r=e.index,n=e.teaParams,i=e.reportTeaParams,u=O(void 0===r?0:r,e.itemListKey,e.itemListConfigId,n);x.openImmersivePlayer(u),K.current=Number(Date.now());var a=(null==n?void 0:n.author_id)&&(null==S?void 0:S.uid)===n.author_id,s=m.L.getScreenRatio(),c=(0,o._)((0,t._)({},null!=i?i:n,s),{enter_method:U?"click_comment":"click_preview_card",play_mode:v.Tk.ImmersivePlayer,is_self_content:a});f.f.sendEvent("enter_immersive_player",c),m.L.handleEnterBrowserOpt(c)},[O,K,x]),W=(0,a.useCallback)(function(){A("close-browser-mode")},[A]);return(0,u.FD)(d.g.Provider,{value:{showBrowserMode:function(e){var r=e.index,n=e.teaParams,t=e.reportTeaParams,o=e.itemListKey,i=e.id;Y()||q({index:r,teaParams:n,reportTeaParams:t,itemListKey:o,itemListConfigId:i})},closeBrowserMode:W,isBrowserModeShowing:T,isLiveBrowserShowing:T},children:[(0,u.Y)(e,(0,t._)({},n)),(0,u.Y)(k,{})]})};return y.displayName="WithImmersivePlayer(".concat(null!=(n=e.displayName)?n:e.name,")"),y}}},96375:function(e,r,n){n.d(r,{Cd:function(){return v}});var t=n(5377),o=n(45996),i=n(40099),u=n(45755),a=n(90542),s=n(62650),c=n(48859),l=n(11854),d=n(24874),f=i.createRef(),m=function(){var e=(0,d.Z)(function(e){return{teaParams:e.teaParams}},l.bN).teaParams;return{reportExitImmersivePlayer:(0,i.useCallback)(function(r){if(r&&f.current){var n=Number(new Date),i=(0,o._)((0,t._)((0,o._)((0,t._)({},s.L.getScreenRatio()),{duration:f.current?(n-f.current)/1e3:void 0}),e),{enter_method:r,play_mode:c.Tk.ImmersivePlayer});s.L.handleExitBrowser(i),a.f.sendEvent("exit_immersive_player",i),f.current=null}},[e])}},v=function(){var e=m().reportExitImmersivePlayer,r=(0,u.kh)();return{enterTimeRef:f,closeImmersivePlayer:(0,i.useCallback)(function(n){e(n),r.closeImmersivePlayer()},[r,e]),reportExitImmersivePlayer:e}}},24874:function(e,r,n){n.d(r,{Z:function(){return f},w:function(){return d}});var t=n(5377),o=n(45996),i=n(6586),u=n(49244),a=n(77443),s=n(45755),c=n(20386),l=n(11854),d=function(e){return(0,i._)((0,a.S)(u.O,{selector:function(r){var n;return null!=(n=r[null!=e?e:""])?n:{list:[]}},dependencies:[e]}),1)[0]},f=function(){for(var e,r=arguments.length,n=Array(r),u=0;u<r;u++)n[u]=arguments[u];var a=(0,i._)(n,2),f=a[0],m=a[1],v=(0,s.Z9)(f,m),h=(0,s.Z9)(function(e){return e},l.bN),w=h.itemListSourceConfig,p=d((null==w?void 0:w.mode)==="single"?w.itemListKey:void 0);return(null==w?void 0:w.mode)==="single"?(0,c.D)(w.itemListKey)?v:f((0,o._)((0,t._)({},h),{itemList:null!=(e=p.list)?e:[]})):v}},6232:function(e,r,n){n.d(r,{Y:function(){return o}});var t,o=((t={}).PlayerChange="player_change",t.PlayerDestroy="player_destroy",t.PlayerMounted="player_mounted",t.OneColumnRerender="one_column_rerender",t.BrowseModeRerender="browse_mode_rerender",t.VideoRequest="video_request",t.VideoCanPlay="video_can_play",t.VideoFirstFrame="video_first_frame",t)},34595:function(e,r,n){n.d(r,{X:function(){return t},d:function(){return o}});var t=function(e){try{var r=btoa(e);return r=r.replace(/=+$/,""),encodeURIComponent(r)}catch(e){return null}},o=function(e){try{var r=decodeURIComponent(e),n="",t=r.length%4;2===t?n="==":3===t&&(n="=");var o=atob(r+n);if(!o)throw Error();return o}catch(e){return null}}},15764:function(e,r,n){n.d(r,{uQ:function(){return i},xt:function(){return a}});var t=n(6586),o=n(6232);function i(e){return performance.mark(e)}function u(e){var r=e.start,n=e.end;try{return performance.measure("".concat(r,"-").concat(n),r,n)}catch(e){}}function a(){var e,r,n,i=[o.Y.PlayerDestroy,o.Y.PlayerMounted,o.Y.OneColumnRerender,o.Y.BrowseModeRerender,o.Y.VideoRequest,o.Y.VideoFirstFrame].map(function(e){var r,n,t;return(t=null!=(n=null==(r=u({start:o.Y.PlayerChange,end:e}))?void 0:r.duration)?n:0)<0?0:t}),a=(0,t._)(i,6);return{destroy_time:a[0],mounted_time:a[1],one_column_rerender_time:a[2],browse_mode_rerender_time:a[3],video_request_time:a[4],video_first_frame_time:a[5],player_first_frame_time:(n=null!=(r=null==(e=u({start:o.Y.VideoRequest,end:o.Y.VideoFirstFrame}))?void 0:e.duration)?r:0)<0?0:n}}},44117:function(e,r,n){n.d(r,{J:function(){return h},K:function(){return v}});var t=n(40099),o=n(94553),i=n(72961),u=n(43264),a=n(13610),s=n(55778),c=n(17505),l=[o.L.Trending,o.L.Explore,o.L.PhotoVideo,o.L.Video,o.L.SearchVideo,o.L.SearchUser,o.L.SearchPhoto,o.L.GeneralSearch],d=[o.L.Trending];function f(){var e=(0,i.L$)((0,u.W)(function(){return["user","region"]},[])),r=e.user,n=e.region,o=(0,i.L$)((0,a.U)(function(){return["forceLoginSpecialRegions"]},[])).forceLoginSpecialRegions,s=(0,c.bb3)().enableBrazil12hCumulativePlay;return(0,t.useMemo)(function(){if(r)return!1;var e=null==o?void 0:o.includes(n);return"BR"===n&&e?!s:!!e},[o,n,r,s])}function m(){window&&(window.location.href="/login?redirect_url=".concat((0,s.Q2)()))}function v(e){var r=f(),n=(0,i.L$)((0,a.U)(function(){return["isMobile"]},[])).isMobile,o=void 0!==n&&n?d:l,u=!!e&&(null==o?void 0:o.includes(e));(0,t.useEffect)(function(){r&&u&&m()},[e,r,u])}function h(){var e=f();return(0,t.useCallback)(function(){return!!e&&(m(),!0)},[e])}},82232:function(e,r,n){n.d(r,{N:function(){return i}});var t=n(40099),o=n(10874);function i(e){var r=(0,t.useRef)(),n=(0,o.useHistory)();(0,t.useEffect)(function(){var t,o,i=null!=(o=null==n||null==(t=n.location)?void 0:t.pathname)?o:"";i&&r.current!==i&&(null==e||e(r.current,i),r.current=i)},[n,e])}},43599:function(e,r,n){n.d(r,{w:function(){return d}});var t=n(6586),o=n(40099),i=n(11854),u=n(35702),a=n(93844),s=n(57007),c=n(51794),l=n(72074);function d(){var e=(0,a.s)(),r=(0,t._)((0,l.W)(function(e){return{statusCode:e.statusCode,statusMessage:e.statusMessage,action:e.action,toastNotShown:e.toastNotShown}},i.bN),2),n=r[0],d=n.statusCode,f=n.statusMessage,m=n.action,v=n.toastNotShown,h=r[1];(0,o.useEffect)(function(){var r;if(v){switch(d){case s.s.Ok:"delete"===m&&(r=e("deleted"));break;case s.s.AdVideoUnavailableChange:r=f;break;case s.s.VideoUnavailableDeleted:r=e("video_unavailable_deleted");break;default:r=e(c.Sw)}u.F.destroy(),u.F.open({content:r,duration:3,widthType:"half"}),h.clearBrowserModeStatus()}},[e,v,d,f,m,h])}},85400:function(e,r,n){n.d(r,{u:function(){return b}});var t=n(5377),o=n(2787),i=n(40099),u=n(84287),a=n(62085),s=n(43264),c=n(54363),l=n(15764),d=n(6232),f=n(15305),m=n(55169),v=n(41150),h=n(82232),w=n(59384),p=n(43599),_=n(18117),y=(0,m.Rq)({resolved:{},chunkName:function(){return"instance"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("96821"),n.e("49871"),n.e("41685"),n.e("84673"),n.e("44810"),n.e("19517"),n.e("79447"),n.e("18008"),n.e("2536"),n.e("18684"),n.e("50613"),n.e("17214"),n.e("34807"),n.e("69435"),n.e("17866"),n.e("584"),n.e("71522"),n.e("49750"),n.e("85439"),n.e("50210"),n.e("52861"),n.e("8324"),n.e("4722"),n.e("89828"),n.e("32132"),n.e("74929"),n.e("88447"),n.e("96308"),n.e("99698"),n.e("5244"),n.e("56448"),n.e("12707"),n.e("84363"),n.e("96439"),n.e("96755"),n.e("37718"),n.e("14725"),n.e("55759"),n.e("96261"),n.e("79874"),n.e("74898"),n.e("23382"),n.e("85178"),n.e("28939")]).then(n.bind(n,8416))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 8416}},(0,t._)({},v.KE)),g=(0,m.Rq)({resolved:{},chunkName:function(){return"live-top-modules-live-browser-mode-live-browser-mode"},isReady:function(e){var r=this.resolve(e);return!0===this.resolved[r]&&!!n.m[r]},importAsync:function(){return Promise.all([n.e("41685"),n.e("84673"),n.e("65514"),n.e("95747"),n.e("71522"),n.e("44735"),n.e("45931"),n.e("82856"),n.e("87564")]).then(n.bind(n,35160))},requireAsync:function(e){var r=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then(function(e){return r.resolved[n]=!0,e})},requireSync:function(e){return n(this.resolve(e))},resolve:function(){return 35160}},(0,t._)({},v.KE));function b(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.s.BrowserMode;return function(u){var m=function(f){var m,v,b=(0,_.m)(),L=b.itemListKey,C=b.currentIndex,P=b.closeBrowserMode,M=b.isLiveBrowserShowing,k=b.isBrowserModeShowing,S=b.disableUpdate,B=b.showBrowserMode,R=b.teaParams,I=b.enterFrom,E=(0,w.YZ)(),T=(0,a.b1)(),x=(0,s.W)(function(){return["abTestVersion"]},[]),N=null!=(m=(0,c.qt)(null==x?void 0:x.abTestVersion,"search_video"))?m:"v1",D=(null!=(v=(0,s.W)(function(){return["user"]},[]))?v:{}).user,V=E.getAdjacentVideoInfo(),K=("general_search"===I||"search_video"===I)&&!D,A=(0,i.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.playProgress,t=e.fromPopState;P({playProgress:n,shouldPause:e.shouldPause}),!t&&r&&window.history.back()},[P]),Y=(0,i.useCallback)(function(){E.setClickSamePage()},[E]);(0,h.N)(function(){k&&P(void 0)}),(0,i.useEffect)(function(){E.setItemListKey(e)},[E]),(0,i.useEffect)(function(){(0,l.uQ)(d.Y.BrowseModeRerender)});var F=(0,i.useMemo)(function(){return{closeBrowserMode:P,showBrowserMode:B,isBrowserModeShowing:k,isLiveBrowserShowing:M}},[P,k,M,B]),U=(0,i.useCallback)(function(){if((0,l.uQ)(d.Y.PlayerChange),5===C&&K&&("v3"===N||"v4"===N))return void T.openModal({isSignup:!1,query:{redirect_url:window.location.href,enter_method:"click_top_bar",enter_from:I,type:"loginsearchmore"}});E.handleNextVideo()},[C,T,N,I,K,E]),O=(0,i.useCallback)(function(){(0,l.uQ)(d.Y.PlayerChange),E.handlePrevVideo()},[E]);return(0,p.w)(),(0,o.FD)(_.g.Provider,{value:F,children:[(0,o.Y)(u,(0,t._)({},f)),M?(0,o.Y)(g,{itemListKey:L,currentIndex:C,zIndex:n,onCloseBrowserMode:A,onNextVideo:U,onPrevVideo:O}):k&&(0,o.Y)(y,{disableUpdate:S,itemListKey:L,currentIndex:C,onNextVideo:U,onPrevVideo:O,needUrlDelegate:r,zIndex:n,onCloseBrowserMode:A,teaParams:R,onJumpSamePage:Y,adjacentVideoIds:V})]})};return m.displayName="WithBrowserMode(".concat((0,f.x)(u),")"),m}}}}]);