"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["85439"],{93036:function(e,t,n){n.d(t,{t:function(){return a}});var r,a=((r={}).H265="web_h265",r.H264="web_h264",r)},83814:function(e,t,n){n.d(t,{$l:function(){return c},AF:function(){return s},GH:function(){return h},gc:function(){return l}});var r,a=n(32049),o=n(95794),i='video/mp4;codecs="hev1.1.6.L93.B0"';function c(e){return[3,4,31].includes(e)}function s(){return!(0,a.fU)()&&"undefined"!=typeof MediaSource&&(!!MediaSource.isTypeSupported(i)&&"probably"===document.createElement("video").canPlayType(i)||!1)}var u="hevc_support_key_v4",d="hevc_support_key_time";function l(){if((0,a.fU)())return!1;if(void 0!==r)return r;var e=(0,o._S)(u,""),t=Number((0,o._S)(d,"0"));return Date.now()-t>12096e5||""===e?(r=s(),(0,o.AP)(u,r?"1":"0"),(0,o.AP)(d,String(Date.now())),r&&navigator.mediaCapabilities.decodingInfo({type:"file",video:{contentType:i,width:1920,height:1080,bitrate:1e4,framerate:30}}).then(function(e){var t=e.supported;r=t,(0,o.AP)(u,t?"1":"0")}).catch(function(e){return console.error(e)}),r):"1"===e}function h(){(0,o.AP)(u,"0"),(0,o.AP)(d,String(Date.now())),r=!1}},83153:function(e,t,n){n.d(t,{A:function(){return c}});var r=n(40099),a=n(32049),o=n(93036),i=n(83814);function c(){var e=(0,r.useMemo)(function(){return(0,i.gc)()},[]),t=(0,r.useMemo)(function(){return(0,a.fU)()?o.t.H264:e?o.t.H265:o.t.H264},[e]);return{openH265:t===o.t.H265,streamDeviceType:t,hevcSupport:e}}},76232:function(e,t,n){n.d(t,{AF:function(){return p},AP:function(){return _},CA:function(){return h},Sf:function(){return v},a8:function(){return f},hA:function(){return l},uJ:function(){return S}});var r=n(10874),a=n(23680),o=n(72961),i=n(43264),c=n(54363),s=n(88947),u=n(10829),d="abTestVersion",l=function(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion,n=null!=(e=(0,c.qt)(t,"search_bar_style_opt"))?e:"v1",r="v2"===n,a="v3"===n;return{isSearchBarStyleV1:"v1"===n,isSearchBarStyleV2:r,isSearchBarStyleV3:a,withNewStyle:r||a}},h=function(){var e,t=(0,r.useLocation)().pathname,n=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion,a=null!=(e=(0,c.qt)(n,"search_add_related_search"))?e:"v0";return{hasRelatedSearch:(0,s.ie)(t)||"v0"!==a}},p=function(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion;return"v2"===(null!=(e=(0,c.qt)(t,"search_keep_sug_show"))?e:"v1")};function S(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion,n=null!=(e=(0,c.qt)(t,"search_add_non_personalized_switch"))?e:"v1",r=(0,a.P)(u.L,{selector:function(e){var t;return{user:null==(t=e.appContext)?void 0:t.user}},dependencies:[]}).user;return{hasPersonalizedSwitch:"v2"===n&&!!r}}function f(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion;return{shouldRecomReduceIconRisk:"v1"===(null!=(e=(0,c.qt)(t,"should_recom_reduce_icon_risk"))?e:"v0")}}function _(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion;return{notificationShouldBeClickable:"v1"===(null!=(e=(0,c.qt)(t,"webapp_moderation"))?e:"v0")}}function v(){var e,t=(0,o.L$)((0,i.W)(function(){return[d]},[])).abTestVersion;return{showLiveHead:"v1"===(null!=(e=(0,c.qt)(t,"show_search_live_head"))?e:"v0")}}},16786:function(e,t,n){n.d(t,{rk:function(){return ea},cE:function(){return en},ol:function(){return er}});var r,a=n(40099),o=n(90059),i=n(79066),c=n(35383),s=n(5377),u=n(45996),d=n(72516),l=n(73455),h=n(4676),p=n(10625),S=n(90542),f=n(57007),_=n(83751),v=n(80085),g=n(94553),y=(r={},(0,c._)(r,o.nX.General,g.L.GeneralSearch),(0,c._)(r,o.nX.Video,g.L.SearchVideo),(0,c._)(r,o.nX.Live,g.L.SearchLive),(0,c._)(r,o.nX.User,g.L.SearchUser),(0,c._)(r,o.nX.Photo,g.L.SearchPhoto),r),R=n(42646),m=n(56904),P=function(e,t,n,r){if(!(e.length<10)){var a={enter_from:n,words_source:o.rU.RelatedSearch,search_position:S.f.commonParams.page_name,page_name:r};o.$G.handleTrendingShow((0,s._)({words_num:e.length,impr_id:t,raw_query:""},a)),e.forEach(function(e,n){var r,i;return o.$G.handleTrendingWordsShow((0,s._)({words_position:n,words_content:null!=(r=null==e?void 0:e.word)?r:"",group_id:null!=(i=null==e?void 0:e.group_id)?i:"",impr_id:t},a))})}},b=(0,l._)((0,p.p)("relatedSearchAtom@tiktok/webapp-atoms",{}),{rehydrationKey:"webapp.related-search"}),w=(0,h.i)(b,function(e,t){return{setShowRelatedSearchPanel:function(e,n){t(b,function(t){return(0,u._)((0,s._)({},t),(0,c._)({},e,(0,u._)((0,s._)({},t[e]),{shouldShowRelatedSearchPanel:n})))})},getRelatedSearchData:function(n,r){return(0,i._)(function(){var a,o,l,h,p,S,g;return(0,d.__generator)(this,function(w){switch(w.label){case 0:if(a=e(b)[n],o=!e(_.WH).isSearchPersonalized,null==a?void 0:a.isLoading)return[2];w.label=1;case 1:var L;return w.trys.push([1,3,,4]),t(b,function(e){return(0,u._)((0,s._)({},e),(0,c._)({},n,(0,u._)((0,s._)({},e[n]),{isLoading:!0})))}),[4,(L=(0,u._)((0,s._)({},r),{is_non_personalized_search:o?1:void 0}),(0,i._)(function(){return(0,d.__generator)(this,function(e){return[2,R.h.get("/api/search/suggest/guide/",{query:L,baseUrlType:m.Z4.FixedWww})]})})())];case 2:if((h=w.sent()).status_code!==f.s.Ok)throw Error();return S=(null!=(p=h.data)?p:[]).map(function(e){return(0,u._)((0,s._)({},e),{impr_id:h.log_id})}),g=null==(l=e(v.pg).searchGlobalParams)?void 0:l.rootEnterFrom,P(S,h.log_id,g,y[n]),t(b,function(e){return(0,u._)((0,s._)({},e),(0,c._)({},n,(0,u._)((0,s._)({},h),{data:S,shouldShowRelatedSearchPanel:!1})))}),[3,4];case 3:return console.warn({error:w.sent()}),[3,4];case 4:return t(b,function(e){return(0,u._)((0,s._)({},e),(0,c._)({},n,(0,u._)((0,s._)({},e[n]),{isLoading:!1})))}),[2]}})})()}}}),L=(w.useAtomService,w.getStaticApi,w.useServiceDispatchers),k=w.useServiceState,F=n(17505),T=n(59549),X=n(48748),O=n(95170),D=n(7120),V=n(6586),E=n(79262),A=n(23999),j=n(76435),G=n(19293),U=n(24451),z=n(62564),$=n(72916),q=n(95719),Z=n(68710),M=n(74690),H=n(78990),W=n(82379),I=n(1455),B=n(48106),C=n(38653),N=n(84772),J=n(96062);function Q(e,t){if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var x=function(){function e(t){(0,O._)(this,e),this.fetch=t}return e.prototype.getRelatedSearch=function(e){return this.fetch.get("/api/search/suggest/guide/",{query:e,baseUrlType:m.Z4.FixedWww})},e}();function K(e,t,n,r){var a,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(i=(o<3?a(i):o>3?a(t,n,i):a(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}function Y(e,t){if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}x=function(e,t,n,r){var a,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(("undefined"==typeof Reflect?"undefined":(0,E._)(Reflect))==="object"&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(i=(o<3?a(i):o>3?a(t,n,i):a(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i}([(0,N._q)(),Q("design:type",Function),Q("design:paramtypes",[void 0===J.p?Object:J.p])],x);var ee=function(e){function t(e,n,r){var a,i;return(0,O._)(this,t),(a=(0,X._)(this,t)).service=e,a.search=n,a.personalization=r,i={},(0,c._)(i,o.nX.General,{}),(0,c._)(i,o.nX.Video,{}),(0,c._)(i,o.nX.User,{}),(0,c._)(i,o.nX.Live,{}),(0,c._)(i,o.nX.Photo,{}),a.defaultState=i,a}(0,D._)(t,e);var n=t.prototype;return n.setGeneralState=function(e,t){e[o.nX.General]=t},n.setUserState=function(e,t){e[o.nX.User]=t},n.setVideoState=function(e,t){e[o.nX.Video]=t},n.setPhotoState=function(e,t){e[o.nX.Photo]=t},n.setLiveState=function(e,t){e[o.nX.Live]=t},n.setGeneralStateShowRelatedSearchPanel=function(e,t){e[o.nX.General]=(0,u._)((0,s._)({},e[o.nX.General]),{shouldShowRelatedSearchPanel:t})},n.setUserStateShowRelatedSearchPanel=function(e,t){e[o.nX.User]=(0,u._)((0,s._)({},e[o.nX.User]),{shouldShowRelatedSearchPanel:t})},n.setVideoStateShowRelatedSearchPanel=function(e,t){e[o.nX.Video]=(0,u._)((0,s._)({},e[o.nX.Video]),{shouldShowRelatedSearchPanel:t})},n.setPhotoStateShowRelatedSearchPanel=function(e,t){e[o.nX.Photo]=(0,u._)((0,s._)({},e[o.nX.Photo]),{shouldShowRelatedSearchPanel:t})},n.setLiveStateShowRelatedSearchPanel=function(e,t){e[o.nX.Live]=(0,u._)((0,s._)({},e[o.nX.Live]),{shouldShowRelatedSearchPanel:t})},n.getTopRelatedSearchData=function(e){var t=this;return e.pipe((0,U.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,V._)(e,3),n=t[0],r=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:n,rootEnterFrom:null==r?void 0:r.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var n=e.payload,r=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},n),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,q.M)(function(e){var n=e.data,a=e.log_id;t.reportTrendingShow(n,a,r,g.L.GeneralSearch)}),(0,Z.Z)(function(e){var n=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setGeneralState(n))}),(0,M.Z)(t.getActions().setGeneralState({})),(0,j.Q)(t.getAction$().dispose))}))},n.getVideoRelatedSearchData=function(e){var t=this;return e.pipe((0,U.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,V._)(e,3),n=t[0],r=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:n,rootEnterFrom:null==r?void 0:r.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var n=e.payload,r=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},n),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,q.M)(function(e){var n=e.data,a=e.log_id;t.reportTrendingShow(n,a,r,g.L.SearchVideo)}),(0,Z.Z)(function(e){var n=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setVideoState(n))}),(0,M.Z)(t.getActions().setVideoState({})),(0,j.Q)(t.getAction$().dispose))}))},n.getPhotoRelatedSearchData=function(e){var t=this;return e.pipe((0,U.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,V._)(e,3),n=t[0],r=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:n,rootEnterFrom:null==r?void 0:r.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var n=e.payload,r=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},n),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,q.M)(function(e){var n=e.data,a=e.log_id;t.reportTrendingShow(n,a,r,g.L.SearchPhoto)}),(0,Z.Z)(function(e){var n=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setPhotoState(n))}),(0,M.Z)(t.getActions().setPhotoState({})),(0,j.Q)(t.getAction$().dispose))}))},n.getUserRelatedSearchData=function(e){var t=this;return e.pipe((0,U.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,V._)(e,3),n=t[0],r=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:n,rootEnterFrom:null==r?void 0:r.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var n=e.payload,r=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},n),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,q.M)(function(e){var n=e.data,a=e.log_id;t.reportTrendingShow(n,a,r,g.L.SearchUser)}),(0,Z.Z)(function(e){var n=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setUserState(n))}),(0,M.Z)(t.getActions().setUserState({})),(0,j.Q)(t.getAction$().dispose))}))},n.getLiveRelatedSearchData=function(e){var t=this;return e.pipe((0,U.E)(this.search.state$,this.personalization.state$),(0,z.T)(function(e){var t=(0,V._)(e,3),n=t[0],r=t[1].searchGlobalParams,a=t[2].isSearchPersonalized;return{payload:n,rootEnterFrom:null==r?void 0:r.rootEnterFrom,nonPersonalized:a?void 0:1}}),(0,$.n)(function(e){var n=e.payload,r=e.rootEnterFrom,a=e.nonPersonalized;return t.service.getRelatedSearch((0,u._)((0,s._)({},n),{is_non_personalized_search:a})).pipe((0,z.T)(function(e){return t.handleRequestData(e)}),(0,q.M)(function(e){var n=e.data,a=e.log_id;t.reportTrendingShow(n,a,r,g.L.SearchLive)}),(0,Z.Z)(function(e){var n=(0,u._)((0,s._)({},e),{shouldShowRelatedSearchPanel:!1});return(0,A.of)(t.getActions().setLiveState(n))}),(0,M.Z)(t.getActions().setLiveState({})),(0,j.Q)(t.getAction$().dispose))}))},n.handleRequestData=function(e){var t=e.status_code,n=e.data,r=void 0===n?[]:n,a=e.log_id,o=[];return t===f.s.Ok&&(null==r?void 0:r.length)&&(o=r.map(function(e){return(0,u._)((0,s._)({},e),{impr_id:a})})),(0,u._)((0,s._)({},e),{data:null!=o?o:[]})},n.reportTrendingShow=function(e,t,n,r){if(e&&e.length>=10){var a={enter_from:n,words_source:o.rU.RelatedSearch,search_position:S.f.commonParams.page_name,page_name:r};o.$G.handleTrendingShow((0,s._)({words_num:e.length,impr_id:null!=t?t:"",raw_query:""},a)),e.forEach(function(e,n){var r,i;return o.$G.handleTrendingWordsShow((0,s._)({words_position:n,words_content:null!=(r=null==e?void 0:e.word)?r:"",group_id:null!=(i=null==e?void 0:e.group_id)?i:"",impr_id:null!=t?t:""},a))})}},t}(H.E);K([(0,W.uk)(),Y("design:type",void 0===G.c?Object:G.c)],ee.prototype,"dispose",void 0),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setGeneralState",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setUserState",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setVideoState",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setPhotoState",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,"undefined"==typeof RelatedSearchPayload?Object:RelatedSearchPayload]),Y("design:returntype",void 0)],ee.prototype,"setLiveState",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setGeneralStateShowRelatedSearchPanel",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setUserStateShowRelatedSearchPanel",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setVideoStateShowRelatedSearchPanel",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setPhotoStateShowRelatedSearchPanel",null),K([(0,W.h5)(),Y("design:type",Function),Y("design:paramtypes",["undefined"==typeof RelatedSearchState?Object:RelatedSearchState,Boolean]),Y("design:returntype",void 0)],ee.prototype,"setLiveStateShowRelatedSearchPanel",null),K([(0,W.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===G.c?Object:G.c]),Y("design:returntype",void 0)],ee.prototype,"getTopRelatedSearchData",null),K([(0,W.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===G.c?Object:G.c]),Y("design:returntype",void 0)],ee.prototype,"getVideoRelatedSearchData",null),K([(0,W.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===G.c?Object:G.c]),Y("design:returntype",void 0)],ee.prototype,"getPhotoRelatedSearchData",null),K([(0,W.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===G.c?Object:G.c]),Y("design:returntype",void 0)],ee.prototype,"getUserRelatedSearchData",null),K([(0,W.Mj)(),Y("design:type",Function),Y("design:paramtypes",[void 0===G.c?Object:G.c]),Y("design:returntype",void 0)],ee.prototype,"getLiveRelatedSearchData",null),ee=K([(0,I.nV)("RelatedSearch"),Y("design:type",Function),Y("design:paramtypes",[void 0===x?Object:x,void 0===C.tq?Object:C.tq,void 0===B.f?Object:B.f])],ee);var et=(0,T.K)(function(){return(0,F.XRV)().shouldUseSearchPageJotai},ee,{useServiceState:k,useServiceDispatchers:function(){var e=L();return(0,a.useMemo)(function(){return{setGeneralStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.General,t)},setVideoStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.Video,t)},setPhotoStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.Photo,t)},setUserStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.User,t)},setLiveStateShowRelatedSearchPanel:function(t){return e.setShowRelatedSearchPanel(o.nX.Live,t)},getTopRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.General,t)},getVideoRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.Video,t)},getUserRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.User,t)},getPhotoRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.Photo,t)},getLiveRelatedSearchData:function(t){return e.getRelatedSearchData(o.nX.Live,t)},dispose:function(){}}},[])}}),en=et.useSigiOrJotaiService,er=et.useSigiOrJotaiState,ea=et.useSigiOrJotaiDispatchers},93538:function(e,t,n){n.d(t,{Ae:function(){return E},DQ:function(){return j},Y6:function(){return A},gc:function(){return O},nY:function(){return D},u5:function(){return X}});var r,a=n(35383),o=n(5377),i=n(45996),c=n(6586),s=n(90421),u=n(26869),d=n(40099),l=n(10874),h=n(89786),p=n(77443),S=n(90059),f=n(59952),_=n(38306),v=n(83751),g=n(43264),y=n(13610),R=n(54363),m=n(11854),P=n(83153),b=n(76232),w=n(26668),L=n(16786),k=n(49244),F=n(38653),T=n(89525);function X(){var e,t=(0,l.useLocation)(),n=t.search,r=t.state,a=null!=r?r:{},o=a.enterMethod,i=a.searchSource,c=a.enterFrom,s=a.fromSearchSubTab,d=a.imprId,h=a.blankpageEnterFrom,p=a.blankpageEnterMethod,S=a.videoPageType,f=a.preClickId,_=(0,u.parse)(n).q;return{enterMethod:o,searchSource:i,enterFrom:c,keyword:null!=(e=Array.isArray(_)?_.toString():_)?e:"",fromSearchSubTab:s,imprId:d,blankpageEnterFrom:h,blankpageEnterMethod:p,videoPageType:S,preClickId:f}}function O(e){var t,n,r=X(),a=r.keyword,o=r.enterMethod,i=r.searchSource,s=r.enterFrom,u=r.fromSearchSubTab,f=r.imprId,v=r.blankpageEnterFrom,R=r.blankpageEnterMethod,b=r.videoPageType,L=r.preClickId,O=null!=(t=(0,g.W)(function(){return["user","language","abTestVersion"]},[]))?t:{},D=O.user,V=O.language,E=void 0===V?"en":V,j=O.abTestVersion,G=null!=(n=(0,y.U)(function(){return["searchVideoForLoggedin","searchLiveForLoggedin"]},[]))?n:{},U=G.searchVideoForLoggedin,z=G.searchLiveForLoggedin,$=(0,l.useLocation)(),q=(0,P.A)().streamDeviceType,Z=$.pathname,M=!!D,H=(0,c._)((0,T.es)(function(t){var n;return{searchResult:t[e],rootEnterFrom:null==(n=t.searchGlobalParams)?void 0:n.rootEnterFrom}},m.bN),2),W=H[0],I=W.searchResult,B=W.rootEnterFrom,C=H[1],N=(0,p.w)(k.O),J=(0,p.w)(w.F),Q=Z===h.OZ.searchUser,x=A();return(0,d.useCallback)(function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=a!==(null==I?void 0:I.keyword)||t,c=a!==(null==I?void 0:I.keyword)||n,d=!U||M,l=!z||M,p={search_source:null!=i?i:S.Cy.SearchOuter,search_type:e,enter_method:o,from_search_subtab:u,enter_from:null!=s?s:B,pre_click_id:null!=f?f:L,pre_recom_show_id:f,blankpage_enter_from:v,blankpage_enter_method:R,video_page_type:b};switch(e){case S.nX.General:Z===h.OZ.searchHome&&r&&d&&(c&&(C.setSearchResult({key:S.nX.General,result:F.I4}),N.resetItemList({key:_.Lz.SearchTop,loading:!0})),C.getTopSearch({keyword:a,teaParams:p,user:D,language:E,abTestVersion:j,hasSearchLive:x,search_source:i,device_type:q}));break;case S.nX.User:Q&&r&&(c&&C.setSearchResult({key:S.nX.User,result:F.Fy}),C.getUserSearch({keyword:a,teaParams:p,user:D,language:E,abTestVersion:j}));break;case S.nX.Video:Z===h.OZ.searchVideo&&r&&d&&(c&&(C.setSearchResult({key:S.nX.Video,result:F.Fy}),N.resetItemList({key:_.Lz.SearchVideo,loading:!0})),C.getVideoSearch({keyword:a,teaParams:p,user:D,language:E,abTestVersion:j}));break;case S.nX.Live:Z===h.OZ.searchLive&&r&&l&&(c&&(C.setSearchResult({key:S.nX.Live,result:F.Fy}),J.resetLiveList({key:_.Lz.SearchLive,loading:!0})),C.getLiveSearch({keyword:a,teaParams:p,user:D,language:E,abTestVersion:j,device_type:q}));break;case S.nX.Photo:Z===h.OZ.searchPhoto&&r&&d&&(c&&(C.setSearchResult({key:S.nX.Photo,result:F.Fy}),N.resetItemList({key:_.Lz.SearchPhoto,loading:!0})),C.getPhotoSearch({keyword:a,teaParams:p,user:D,language:E,abTestVersion:j}))}},[q,a,null==I?void 0:I.keyword,U,M,o,i,e,Z,Q,C,D,E,j,N,x,J,z,u,B,f,v,R,L,b])}function D(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=X().keyword,r=(0,l.useLocation)(),a=(0,l.useHistory)(),s=r.state,u=r.pathname,p=!!(0,l.matchPath)(u,{path:h.OZ.searchHome}),f=(0,b.CA)().hasRelatedSearch,_=(0,c._)((0,T.es)(function(t){return{searchResult:t[e]}},m.bN),2),g=_[0].searchResult,y=_[1],R=(0,L.rk)(),P=(0,v.JW)(function(e){return e.isSearchPersonalized},m.bN),w=O(e);return(0,d.useEffect)(function(){if(p){var c,u,d,l,h,_=g.data?!g.error&&(null==(u=g.data)||null==(c=u.videoList)?void 0:c.length)===0&&(null==(l=g.data)||null==(d=l.otherDataList)?void 0:d.length)===0:(null==g||null==(h=g.items)?void 0:h.length)===0,v=n!==g.keyword||_;if(t&&a.replace((0,i._)((0,o._)({},r),{state:(0,o._)({},s)})),w(v),v&&f){var m={req_source:"related_search",search_source:e,keyword:n};switch(e){case S.nX.General:R.getTopRelatedSearchData(m);break;case S.nX.User:R.getUserRelatedSearchData(m);break;case S.nX.Video:R.getVideoRelatedSearchData(m);break;case S.nX.Photo:R.getPhotoRelatedSearchData(m);break;case S.nX.Live:R.getLiveRelatedSearchData(m)}}return function(){y.dispose(),R.dispose()}}},[n,f,e,P]),(0,i._)((0,o._)({},g),{keyword:n,handleSearch:w})}var V=(r={},(0,a._)(r,S.nX.General,h.OZ.searchHome),(0,a._)(r,S.nX.User,h.OZ.searchUser),(0,a._)(r,S.nX.Video,h.OZ.searchVideo),(0,a._)(r,S.nX.Live,h.OZ.searchLive),(0,a._)(r,S.nX.Photo,h.OZ.searchPhoto),r);function E(e,t){var n=(0,d.useRef)(0),r=(0,l.useHistory)(),a=(0,l.useLocation)(),o=X(),i=o.keyword,c=o.enterMethod,u=(0,T.IE)(function(e){return{searchGlobalParams:e.searchGlobalParams}},m.bN).searchGlobalParams,h=(0,f.GF)(),p=a.pathname;(0,d.useEffect)(function(){if((0,l.matchPath)(p,{path:V[t]}))return n.current||(n.current=Date.now()),r.listen(function(r){var a,o=r.pathname,d=Date.now()-n.current,l=null==(a=(0,s.A)(V))?void 0:a[o];S.$G.handleSearchSessionFinish({duration:d,impr_id:e,search_id:e,search_type:t,search_keyword:i,enter_method:c,enter_from:null==u?void 0:u.rootEnterFrom,group_id:h,next_tab:l})})},[e,t,u,h,c])}function A(){var e,t,n=null!=(e=(0,g.W)(function(){return["abTestVersion","user"]},[]))?e:{},r=n.abTestVersion,a=n.user;return"v2"===(0,R.qt)(r,"search_add_live")&&(null==(t=null==a?void 0:a.hasSearchLivePermission)||t)}function j(e){var t=(0,T.Pf)();(0,d.useEffect)(function(){t.setSearchGlobalParams({rootEnterFrom:e})},[t,e])}}}]);